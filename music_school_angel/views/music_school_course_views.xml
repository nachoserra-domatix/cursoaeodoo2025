<?xml version="1.0" encoding="utf-8"?>
<odoo>

<record id="music_school_course_action" model="ir.actions.act_window">
    <field name="name">Courses</field>
    <field name="res_model">music.school.course</field>
    <field name="view_mode">kanban,pivot,list,graph,calendar,form</field>
    <field name="context">{}</field>
    <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
            Create your first course
        </p>
    </field>
</record>

<record id="music_school_course_view_list" model="ir.ui.view">
    <field name="name">music.school.course.view.list</field>
    <field name="model">music.school.course</field>
    <field name="arch" type="xml">
        <list multi_edit="1" string="Courses">
            <field name="name"/>          
            <field name="description" optional="hide"/>
            <field name="state" optional="show"/> 
            <field name="professor_id"/>
            <field name="instrument_id"/>
            <field name="level"/>
            <field name="start_date"/>
            <field name="end_date"/>
            <field name="capacity"/>
        </list>
    </field>
</record>


<record id="music_school_course_view_form" model="ir.ui.view">
    <field name="name">music.school.course.view.form</field>
    <field name="model">music.school.course</field>
    <field name="arch" type="xml">
        <form string="Course">
            <header>
                <button string="Action Draft" invisible="state in ('draft')" name="action_draft" type="object" class="btn-secondary"/>
                <button string="Action In Progress" invisible="state in ('progress')" name="action_progress" type="object" class="btn-sucess"/>
                <button string="Action Finish" invisible="state in ('finished')" name="action_finish" type="object" class="btn-primary"/>
                <button string="Create Lesson" name="create_lesson" type="object" class="btn-primary"/>
                <button string="Assign students" groups="music_school_angel.group_music_school_manager" name="assign_students" type="object" class="btn-secondary"/>
                <button string="Print report" name="action_print_report" context="{'button1': True}" type="object" class="oe_highlight"/>
                <button string="Print report 2" name="action_print_report" context="{'button2': True}" type="object" class="oe_highlight"/>                
                <field name="state" options="{'clickable':1}" widget="statusbar"/>
            </header>
            <sheet>
                <div class="oe_button_box" name="button_box">
                    <button name="action_view_exams" type="object" class="oe_stat_button" icon="fa-bookmark">
                        <field name="exam_count" string="Exams" widget="statinfo"/>
                    </button>
                    <button name="action_view_lessons" type="object" class="oe_stat_button" icon="fa-calendar">
                        <field name="lesson_count" string="Lessons" widget="statinfo"/>
                    </button>
                </div>

                <div class="oe_title">
                    <h1>
                        <field name="name" placeholder="Course"/>
                    </h1>
                </div>
                <group>
                    <group>
                        <field name="professor_id" options="{'no_create':1,'no_quick_create':1,'no_open':1}" domain="[('level', '=', level)]"/>
                        <field name="instrument_id"/>
                        <field name="level"/>
                    </group>
                    <group>
                        <field name="company_id"/>    
                        <field name="start_date"/>
                        <field name="end_date"/>
                        <field name="day_duration"/>
                        <field name="capacity"/>
                    </group>                        
                </group>
                <notebook>
                    <page string="Description">
                        <field name="description"/>
                    </page>
                    <page string="Students">
                            <field name="student_ids"/>
                    </page>
                </notebook>
            </sheet>
        </form>
    </field>
</record>


<record id="music_school_course_view_search" model="ir.ui.view">
    <field name="name">music.school.course.view.search</field>
    <field name="model">music.school.course</field>
    <field name="arch" type="xml">
        <search string="Course">
            <field name="name" filter_domain="['|',('instrument_id', 'ilike', self), ('name', 'ilike', self)]"></field>
            <field name="professor_id"></field>
            <field name="instrument_id"></field>
            <filter name="draft_filter" string="Draft" domain="[('state', '=', 'draft')]" />
            <filter name="progress_filter" string="In Progress" domain="[('state', '=', 'progress')]" />
            <filter name="Professor" string="Professor" context="{'group_by': 'professor_id'}" />
            <filter name="Level" string="Level" context="{'group_by': 'level'}" />
       </search>
    </field>
</record>

<record id="music_school_course_view_kanban" model="ir.ui.view">
    <field name="name">musich.school.course.view.kanban</field>
    <field name="model">music.school.course</field>
    <field name="arch" type="xml">
        <kanban highlight_color="color" default_group_by="state" class="o_kanban_small_column" on_create="quick_create">
            <field name="name"/>
            <field name="professor_id"/>
            <field name="instrument_id"/>
            <field name="level"/>
            <field name="start_date"/>
            <templates>
                <t t-name="menu">
                    <t t-if="widget.editable"><a role="menuitem" type="open" class="dropdown-item">Edit</a></t>
                    <t t-if="widget.deletable"><a role="menuitem" type="delete" class="dropdown-item">Delete</a></t>
                    <field name="color" widget="kanban_color_picker"/> 
                </t>
                <t t-name="card">
                    <field name="name" class="fw-bold fs-5"/>
                    <field name="instrument_id" class=""/>
                    
                    <field name="start_date"/>
                    <footer>
                        <div class="d-flex mt-auto align-items-center">
                            <field name="level" widget="priority" class="me-2"/>
                        </div>
                        <field name="professor_id" widget="many2one_avatar_user" class="ms-auto"/>
                        
                    </footer>
                </t>
            </templates>
        </kanban>
    </field>
</record>


    <record id="music_school_course_view_pivot" model="ir.ui.view">
        <field name="name">music.school.course.view.pivot</field>
        <field name="model">music.school.course</field>
        <field name="arch" type="xml">
            <pivot string="Course">
                <field name="professor_id" type="row"/>
                <field name="start_date" type="col"/>
                <field name="capacity" type="measure"/>
            </pivot>
        </field>
    </record>

    <record id="music_school_course_view_graph" model="ir.ui.view">
        <field name="name">music.school.course.view.graph</field>
        <field name="model">music.school.course</field>
        <field name="arch" type="xml">
            <graph string="Course" type="bar">
                <field name="professor_id"/>
                <field name="capacity" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="music_school_course_view_calendar" model="ir.ui.view">
        <field name="name">music.school.course.view.calendar</field>
        <field name="model">music.school.course</field>
        <field name="arch" type="xml">
            <calendar string="Course" date_start="start_date" date_stop="end_date" color="professor_id">
                <field name="name"/>
                <field name="professor_id"/>
                <field name="instrument_id"/>
                <field name="level"/>
            </calendar>
        </field>
    </record>

</odoo>
